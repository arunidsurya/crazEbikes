<%- include('layout/headerUser') %>
    <%- include('layout/formatPrice') %>

        <header class="header-orders">
            <h1>Your Orders</h1>
        </header>

        <main>
            <% if (ordersData) { %>
             
           
            <% ordersData.forEach((order,index)=> { %> <!-- Iterate over ordersData -->

                <div class="order-container">
                    <h5>#Order Number : <%= index+1 %></h5>
                    <p><%= order._id %></p>
                <div class="order-outline">
                    <div class="deliver-address">
                        <h4>Delivery Address</h4>
                        <h6>
                            <%= order.address.Name %>
                        </h6>
                        <p><span>
                                <%= order.address.Address %>,
                            </span><span>
                                <%= order.address.City %>-
                            </span><span>
                                <%= order.address.Pincode %>
                            </span></p>
                        <p>
                            <%=order.address.State %>
                        </p>
                        <p>Phone Number :<%= order.address.ContactNumber %>
                        </p>
                    </div>
                    <div>
                        <h4>Order Status</h4>
                        <p>Order :<%= order.Status %></p>
                        <p>Order date :<%= order.OrderDate %> </p>
                        <p>Payment method  :<%= order.payment_method %> </p>
                    </div>
                    <div class="order-cancel-button-container">
                        <% if (order.isCancelled) { %> <!-- Use order.isCancelled here -->
                            <p>Order Cancelled</p>
                            <% } else { %>
                                <a href="/user/cancel-order?orderId=<%=order.collectionId %>"><input  type="text" class="btn btn-danger order-cancel-button" value="Cancel Order"></a>
                                <% } %>
                    </div>
                </div>
                <% order.productsArray.forEach(product=> { %>
                    <section class="order">

                        <div>
                            <img class="order-image" src="<%= imgUri + product.imageUrl %>" alt="Image">
                            
                        </div>
                        <div>
                            <p>
                                <%= product.product_name.slice(0,20) %>
                            </p>
                        </div>
                        <div>
                            <p>
                               color: <%= product.color %>
                            </p>
                        </div>

                        <div>
                            <p>
                                <%= product.quantity %> No
                            </p>
                        </div>
                        <div>
                            <p>Price: $<%= formatPrice(product.price)%>
                            </p>
                        </div>

                    </section>
                    <% }) %>
                        <section class="order-total">
                            <p>Total Order price: <span class="order-total-price">$ <%= formatPrice(order.totalPrice) %>
                                        </span></p>
                        </section>
                    </div>
                        <% }) %>
              
                        <% }else {%>
                        <h4>No orders yet</h4>
                        <%}%>
        </main>

        <%- include('layout/footerUser') %>